I'am not proud of this code.
